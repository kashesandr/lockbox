{"version":3,"sources":["main.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_App","App","run","Object","defineProperty","value","undefined","_Auth","_logger","_settings","_Devices","_SignalDetection","logger","log","DEBUG_DEFAULT_CODE","isReadyToSetUpNewCode","auth","Auth","bluetooth","Bluetooth","serialPort","settings","pin","bluetoothSerial","relay","Relay","relayPin","knockDevice","KnockDevice","knockPin","signalDetectionService","SignalDetectionService","onDataReceived","onKnock","e","timestamp","time","lastTime","putTimestamp","setCode","onSignalDetect","code","authenticated","verifyCode","set","setTimeout","_classCallCheck","instance","Constructor","TypeError","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","length","err","Array","isArray","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","fluctuation","_code$slice","slice","_code$slice2","signalEnd","_code$slice3","_code$slice4","codeEnd","coeff","result","forEach","codeItem","index","stamp","withinRange","Logger","isEnabled","message","arg","txt","console","print","bool","P2","P3","Serial3","_Utils","DEFAULT_BAUD_RATE","DEFAULT_DEBOUNCE_TIMEOUT","options","_this","serial","rate","baudRate","debouceTimeout","debounceTimeout","setup","receivedDataArray","onDataReceivedCallback","onDataReceivedDebounced","debounce","_onDataReceived","on","onDataReceiving","bind","data","join","callback","write","SET_WATCH_OPTS_DEFAULT","repeat","edge","setWatchOpts","onKnockCallback","setWatch","onShakeEvent","func","wait","immediate","timeoutId","context","args","arguments","later","apply","callNow","clearTimeout","CODE_DETECT_TIMEOUT_DEFAULT","codeDetectionTimeout","signalTimestamps","signalDetectionInProgress","updateCodeDetectionDebounced","detectCodeDebounced","onCodeDetected","onSignalDetectCallback","timeout"],"mappings":"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","file":"main.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"main\"] = factory();\n\telse\n\t\troot[\"main\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _App = __webpack_require__(1);\n\t\n\t_App.App.run();\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.App = undefined;\n\t\n\tvar _Auth = __webpack_require__(2);\n\t\n\tvar _logger = __webpack_require__(3);\n\t\n\tvar _settings = __webpack_require__(4);\n\t\n\tvar _Devices = __webpack_require__(5);\n\t\n\tvar _SignalDetection = __webpack_require__(7);\n\t\n\t_logger.logger.log('main.js');\n\t\n\tvar DEBUG_DEFAULT_CODE = [0.11071835714, 0.08259338095, 0.10016359523, 0.30911060714, 0.09569125595, 0.51507855357, 0.07772857142];\n\t\n\tvar App = {\n\t\n\t  run: function run() {\n\t\n\t    var isReadyToSetUpNewCode = false;\n\t\n\t    var auth = new _Auth.Auth();\n\t    var bluetooth = new _Devices.Bluetooth({ serialPort: _settings.settings.pin.bluetoothSerial });\n\t    var relay = new _Devices.Relay({ pin: _settings.settings.pin.relayPin });\n\t    var knockDevice = new _Devices.KnockDevice({ pin: _settings.settings.pin.knockPin });\n\t\n\t    var signalDetectionService = new _SignalDetection.SignalDetectionService();\n\t\n\t    bluetooth.onDataReceived(function () {\n\t      _logger.logger.log('ready to set up new code');\n\t      isReadyToSetUpNewCode = true;\n\t    });\n\t\n\t    knockDevice.onKnock(function (e) {\n\t      // todo: generate timestamp based on `e` arg\n\t      // there is a mistake (e.time - e.lastTime) -> fix it\n\t      var timestamp = e.time - e.lastTime;\n\t      signalDetectionService.putTimestamp(timestamp);\n\t    });\n\t\n\t    // TODO: set the code manually\n\t    auth.setCode(DEBUG_DEFAULT_CODE);\n\t\n\t    signalDetectionService.onSignalDetect(function (code) {\n\t\n\t      _logger.logger.log('code-detected', code);\n\t\n\t      if (isReadyToSetUpNewCode) {\n\t        auth.setCode(code);\n\t        _logger.logger.log('new code has been set');\n\t        isReadyToSetUpNewCode = false;\n\t      } else {\n\t        var authenticated = auth.verifyCode(code);\n\t        _logger.logger.log('authenticated', authenticated);\n\t\n\t        if (authenticated) {\n\t          relay.set(0);\n\t          setTimeout(function () {\n\t            relay.set(1);\n\t          }, 400);\n\t        }\n\t      }\n\t    });\n\t  }\n\t\n\t};\n\t\n\texports.App = App;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Auth = undefined;\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _logger = __webpack_require__(3);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t_logger.logger.log('Auth.js');\n\t\n\tvar Auth = function () {\n\t  function Auth() {\n\t    _classCallCheck(this, Auth);\n\t\n\t    this.code = []; // storing key code, an array of timestamps\n\t    this.fluctuation = 150; // TODO: must be in percents\n\t  }\n\t\n\t  _createClass(Auth, [{\n\t    key: \"setCode\",\n\t    value: function setCode(code) {\n\t      if (!code) return;\n\t      if (!(code instanceof Array)) return;\n\t      this.code = code;\n\t    }\n\t  }, {\n\t    key: \"getCode\",\n\t    value: function getCode() {\n\t      return this.code;\n\t    }\n\t  }, {\n\t    key: \"verifyCode\",\n\t    value: function verifyCode(code) {\n\t      if (!code) return false;\n\t      if (!(code instanceof Array)) return false;\n\t      if (code.length !== this.code.length) return false;\n\t\n\t      var _code$slice = code.slice(-1),\n\t          _code$slice2 = _slicedToArray(_code$slice, 1),\n\t          signalEnd = _code$slice2[0];\n\t\n\t      var _code$slice3 = this.code.slice(-1),\n\t          _code$slice4 = _slicedToArray(_code$slice3, 1),\n\t          codeEnd = _code$slice4[0];\n\t\n\t      var coeff = signalEnd / codeEnd;\n\t      var result = true;\n\t      var fluctuation = this.fluctuation;\n\t      this.code.forEach(function (codeItem, index) {\n\t        var stamp = code[index] / coeff;\n\t        var withinRange = stamp + fluctuation >= codeItem && stamp - fluctuation <= codeItem;\n\t        if (!withinRange) result = false;\n\t      });\n\t\n\t      return result;\n\t    }\n\t  }]);\n\t\n\t  return Auth;\n\t}();\n\t\n\texports.Auth = Auth;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.logger = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _settings = __webpack_require__(4);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * Simplest silly logger for debugging\n\t *\n\t * Actually there is a bug with it.\n\t * For some reason the app is unstable when\n\t * something is pushed into console.log,\n\t * as I found - Espruino waits for recipients for logged data\n\t * and breaks logic if there are no ones\n\t *\n\t * @type {Logger}\n\t */\n\tvar Logger = function () {\n\t  function Logger(bluetoothSerial) {\n\t    _classCallCheck(this, Logger);\n\t\n\t    this.isEnabled = false;\n\t    this.bluetoothSerial = bluetoothSerial;\n\t  }\n\t\n\t  _createClass(Logger, [{\n\t    key: 'log',\n\t    value: function log(message, arg) {\n\t      if (!this.isEnabled) return false;\n\t      var txt = message + ': ' + arg;\n\t      if (console && console.log) console.log(txt);\n\t      if (this.bluetoothSerial) this.bluetoothSerial.print(txt);\n\t    }\n\t  }, {\n\t    key: 'enabled',\n\t    value: function enabled(bool) {\n\t      this.isEnabled = bool;\n\t    }\n\t  }]);\n\t\n\t  return Logger;\n\t}();\n\t\n\tvar logger = new Logger(_settings.settings.pin.bluetoothSerial);\n\t\n\t// TODO: enable when debugging\n\t//logger.enabled(true);\n\t\n\texports.logger = logger;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\t// mocking for testing\n\t// TODO: do not include in prod\n\t// let BTN1 = BTN1 || null;\n\t// let P3 = P3 || null;\n\t// let Serial3 = Serial3 || null;\n\t\n\tvar settings = {\n\t  pin: {\n\t    knockPin: P2,\n\t    relayPin: P3,\n\t    bluetoothSerial: Serial3\n\t  }\n\t};\n\t\n\texports.settings = settings;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.KnockDevice = exports.Relay = exports.Bluetooth = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _logger = __webpack_require__(3);\n\t\n\tvar _Utils = __webpack_require__(6);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t_logger.logger.log('Devices.js');\n\t\n\t/**\n\t * Bluetooth module\n\t * example:\n\t *\n\t  ```\n\t    import { Bluetooth } from \"./Devices\";\n\t    let options = {\n\t      serialPort: <Object> // e.g. Serial3\n\t      baudRate: <Number> // e.g. 9600 <- this is default\n\t      debounceTimeout: <Number> // e.g. 100 <- this is default\n\t    };\n\t    let bluetooth = new Bluetooth(options);\n\t  ```\n\t *\n\t */\n\tvar DEFAULT_BAUD_RATE = 9600;\n\tvar DEFAULT_DEBOUNCE_TIMEOUT = 100;\n\t\n\tvar Bluetooth = function () {\n\t  function Bluetooth(options) {\n\t    var _this = this;\n\t\n\t    _classCallCheck(this, Bluetooth);\n\t\n\t    var serial = options.serialPort;\n\t    var rate = options.baudRate || DEFAULT_BAUD_RATE;\n\t    var debouceTimeout = options.debounceTimeout || DEFAULT_DEBOUNCE_TIMEOUT;\n\t    serial.setup(rate);\n\t\n\t    this.receivedDataArray = [];\n\t    this.onDataReceivedCallback = function () {};\n\t\n\t    this.onDataReceivedDebounced = (0, _Utils.debounce)(function () {\n\t      _this._onDataReceived();\n\t    }, debouceTimeout);\n\t\n\t    serial.on('data', this.onDataReceiving.bind(this));\n\t  }\n\t\n\t  _createClass(Bluetooth, [{\n\t    key: \"onDataReceiving\",\n\t    value: function onDataReceiving(data) {\n\t      this.receivedDataArray.push(data);\n\t      this.onDataReceivedDebounced();\n\t    }\n\t  }, {\n\t    key: \"_onDataReceived\",\n\t    value: function _onDataReceived() {\n\t      var data = this.receivedDataArray.join(\"\");\n\t      this.onDataReceivedCallback(data);\n\t      this.receivedDataArray = [];\n\t    }\n\t  }, {\n\t    key: \"onDataReceived\",\n\t    value: function onDataReceived(callback) {\n\t      this.onDataReceivedCallback = callback || function () {};\n\t    }\n\t  }]);\n\t\n\t  return Bluetooth;\n\t}();\n\t\n\t/**\n\t * Relay utility module\n\t * example:\n\t *\n\t\n\t ```\n\t  import { Relay } from \"./Devices\";\n\t  let options = {\n\t    pin: <Object>, // e,g, P1\n\t  };\n\t  let relay = new Relay(options);\n\t\n\t  relay.set(1);\n\t  relay.set(true);\n\t  relay.set(0);\n\t  relay.set(false);\n\t\n\t ```\n\t *\n\t */\n\t\n\tvar Relay = function () {\n\t  function Relay(options) {\n\t    _classCallCheck(this, Relay);\n\t\n\t    this.pin = options.pin;\n\t  }\n\t\n\t  _createClass(Relay, [{\n\t    key: \"set\",\n\t    value: function set(bool) {\n\t      this.pin.write(bool ? 1 : 0);\n\t    }\n\t  }]);\n\t\n\t  return Relay;\n\t}();\n\t\n\t/**\n\t * KnockDevice module\n\t * example:\n\t *\n\t ```\n\t import { KnockDevice } from \"./Devices\";\n\t let options = {\n\t      pin: <Object>, // e,g, P1\n\t      setWatchOpts: <Object> // opts passed to setWatch fn\n\t    };\n\t let knockDevice = new KnockDevice(options);\n\t knockDevice.onKnock((e)=>{\n\t  // callback when knock\n\t });\n\t ```\n\t *\n\t */\n\t\n\tvar SET_WATCH_OPTS_DEFAULT = {\n\t  repeat: true,\n\t  debounce: 25,\n\t  edge: 'rising'\n\t};\n\t\n\tvar KnockDevice = function () {\n\t  function KnockDevice(options) {\n\t    _classCallCheck(this, KnockDevice);\n\t\n\t    _logger.logger.log(\"setup KnockDevice\");\n\t    var pin = options.pin;\n\t    var setWatchOpts = options.setWatchOpts || SET_WATCH_OPTS_DEFAULT;\n\t    this.onKnockCallback = function () {};\n\t    setWatch(this.onShakeEvent.bind(this), pin, setWatchOpts);\n\t  }\n\t\n\t  _createClass(KnockDevice, [{\n\t    key: \"onShakeEvent\",\n\t    value: function onShakeEvent(e) {\n\t      _logger.logger.log(\"KnockDevice onShakeEvent\");\n\t      this.onKnockCallback(e);\n\t    }\n\t  }, {\n\t    key: \"onKnock\",\n\t    value: function onKnock(callback) {\n\t      this.onKnockCallback = callback || function () {};\n\t    }\n\t  }]);\n\t\n\t  return KnockDevice;\n\t}();\n\t\n\texports.Bluetooth = Bluetooth;\n\texports.Relay = Relay;\n\texports.KnockDevice = KnockDevice;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar debounce = function debounce(func, wait, immediate) {\n\t  var timeoutId = null;\n\t  return function () {\n\t    var context = this,\n\t        args = arguments;\n\t    var later = function later() {\n\t      timeoutId = null;\n\t      if (!immediate) func.apply(context, args);\n\t    };\n\t    var callNow = immediate && !timeoutId;\n\t    if (timeoutId) clearTimeout(timeoutId);\n\t    timeoutId = setTimeout(later, wait);\n\t    if (callNow) func.apply(context, args);\n\t  };\n\t};\n\t\n\texports.debounce = debounce;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.SignalDetectionService = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _logger = __webpack_require__(3);\n\t\n\tvar _Utils = __webpack_require__(6);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t_logger.logger.log('signal-detection.js', 'loaded');\n\t\n\t/**\n\t *\n\t * Service that helps to putTimestamp timestamped code\n\t *\n\t */\n\t\n\tvar CODE_DETECT_TIMEOUT_DEFAULT = 2000;\n\t\n\tvar SignalDetectionService = function () {\n\t  function SignalDetectionService() {\n\t    _classCallCheck(this, SignalDetectionService);\n\t\n\t    this.codeDetectionTimeout = CODE_DETECT_TIMEOUT_DEFAULT;\n\t    this.signalTimestamps = [];\n\t    this.signalDetectionInProgress = false;\n\t\n\t    this.updateCodeDetectionDebounced();\n\t  }\n\t\n\t  _createClass(SignalDetectionService, [{\n\t    key: \"updateCodeDetectionDebounced\",\n\t    value: function updateCodeDetectionDebounced() {\n\t      var codeDetectionTimeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.codeDetectionTimeout || CODE_DETECT_TIMEOUT_DEFAULT;\n\t\n\t      _logger.logger.log('SignalDetectionService.updateCodeDetectionDebounced()', codeDetectionTimeout);\n\t      this.detectCodeDebounced = (0, _Utils.debounce)(this.onCodeDetected.bind(this), codeDetectionTimeout);\n\t    }\n\t\n\t    /**\n\t     * todo: define input, modify the `e` variable taken from espruino's `setWatch` fn\n\t     * @param timestamp\n\t     */\n\t\n\t  }, {\n\t    key: \"putTimestamp\",\n\t    value: function putTimestamp(timestamp) {\n\t      _logger.logger.log('SignalDetectionService.putTimestamp()', timestamp);\n\t      if (this.signalDetectionInProgress) {\n\t        this.signalTimestamps.push(timestamp);\n\t      }\n\t      this.signalDetectionInProgress = true;\n\t      this.detectCodeDebounced();\n\t    }\n\t  }, {\n\t    key: \"onCodeDetected\",\n\t    value: function onCodeDetected() {\n\t      _logger.logger.log(\"SignalDetectionService.onCodeDetected\", 'called');\n\t\n\t      var callback = this.onSignalDetectCallback || function () {};\n\t      callback(this.signalTimestamps);\n\t\n\t      this.signalTimestamps = [];\n\t      this.signalDetectionInProgress = false;\n\t    }\n\t  }, {\n\t    key: \"onSignalDetect\",\n\t    value: function onSignalDetect(callback) {\n\t      this.onSignalDetectCallback = callback; // todo check context\n\t    }\n\t  }, {\n\t    key: \"setDetectionTimeout\",\n\t    value: function setDetectionTimeout(timeout) {\n\t      this.codeDetectionTimeout = timeout;\n\t      this.updateCodeDetectionDebounced();\n\t    }\n\t  }, {\n\t    key: \"getTimestamps\",\n\t    value: function getTimestamps() {\n\t      return this.signalTimestamps;\n\t    }\n\t  }]);\n\t\n\t  return SignalDetectionService;\n\t}();\n\t\n\texports.SignalDetectionService = SignalDetectionService;\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}